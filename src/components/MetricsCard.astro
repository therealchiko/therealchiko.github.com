---
import metrics from '../data/metrics.json';

const projects = metrics.projects;
const totalRevenue = projects.reduce((sum, p) => sum + p.revenue, 0);

// Calculate days from earliest start date
const earliestStart = new Date(Math.min(...projects.map(p => new Date(p.startDate).getTime())));
const today = new Date();
const daysSinceStart = Math.floor((today.getTime() - earliestStart.getTime()) / (1000 * 60 * 60 * 24));
---

<div class="space-y-4">
  {projects.map((project) => {
    const projectDays = Math.floor((today.getTime() - new Date(project.startDate).getTime()) / (1000 * 60 * 60 * 24));
    return (
      <a href={`/building/${project.id}/`} class="block p-6 bg-[var(--color-surface)] rounded-2xl border border-transparent hover:border-[var(--color-accent)] transition-all duration-300 group relative overflow-hidden">
        <div class="absolute inset-0 bg-gradient-to-br from-[var(--color-accent)]/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>

        <div class="relative">
          <div class="flex items-center justify-between mb-4">
            <span class="text-xl font-semibold gradient-text">{project.name}</span>
            <span class="text-xs text-[var(--color-muted)] px-2 py-1 rounded-full bg-[var(--color-bg)]">{project.tagline}</span>
          </div>

          <div class="flex items-center gap-6">
            <div>
              <div class="text-2xl font-bold gradient-text">${project.revenue}</div>
              <div class="text-xs text-[var(--color-muted)] uppercase tracking-wider">Total</div>
            </div>
            <div>
              <div class="text-2xl font-bold">{projectDays}</div>
              <div class="text-xs text-[var(--color-muted)] uppercase tracking-wider">Days</div>
            </div>
            <div class="ml-auto text-[var(--color-muted)] group-hover:text-[var(--color-accent)] transition-colors text-sm">
              View journey
              <span class="inline-block transition-transform group-hover:translate-x-1 ml-1">&rarr;</span>
            </div>
          </div>
        </div>
      </a>
    );
  })}
</div>
